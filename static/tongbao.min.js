/*! tongbao 2014-04-16 */
var T,TongBao=T=TongBao||{version:"1.5.2.2"};TongBao.guid="$TONGBAO$",TongBao.$$=window[TongBao.guid]=window[TongBao.guid]||{global:{}},TongBao.dom=TongBao.domg||{},TongBao.dom.g=function(a){return document.getElementById(a)},TongBao.string=TongBao.string||{},function(){var a=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+$)","g");TongBao.string.trim=function(b){return String(b).replace(a,"")}}(),TongBao.string.encodeHTML=function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},TongBao.string.format=function(a,b){a=String(a);var c=Array.prototype.slice.call(arguments,1),d=Object.prototype.toString;return c.length?(c=1==c.length&&null!==b&&/\[object Array\]|\[object Object\]/.test(d.call(b))?b:c,a.replace(/#\{(.+?)\}/g,function(a,b){var e=c[b];return"[object Function]"==d.call(e)&&(e=e(b)),"undefined"==typeof e?"":e})):a},TongBao.number=TongBao.number||{},TongBao.number.pad=function(a,b){var c="",d=0>a,e=String(Math.abs(a));return e.length<b&&(c=new Array(b-e.length+1).join("0")),(d?"-":"")+c+e},TongBao.date=TongBao.data||{},TongBao.date.format=function(a,b){function c(a,c){b=b.replace(a,c)}if("string"!=typeof b)return a.toString();var d=TongBao.number.pad,e=a.getFullYear(),f=a.getMonth()+1,g=a.getDate(),h=a.getHours(),i=a.getMinutes(),j=a.getSeconds();return c(/yyyy/g,d(e,4)),c(/yy/g,d(parseInt(e.toString().slice(2),10),2)),c(/MM/g,d(f,2)),c(/M/g,f),c(/dd/g,d(g,2)),c(/d/g,g),c(/HH/g,d(h,2)),c(/H/g,h),c(/hh/g,d(h%12,2)),c(/h/g,h%12),c(/mm/g,d(i,2)),c(/m/g,i),c(/ss/g,d(j,2)),c(/s/g,j),b},TongBao.json=TongBao.json||{},TongBao.json.parse=function(a){return new Function("return ("+a+")")()},TongBao.json.stringify=function(a){return JSON?JSON.stringify(a):""},TongBao.object=TongBao.object||{},TongBao.object.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},TongBao.fn=TongBao.fn||{},TongBao.fn.blank=function(){},TongBao.ajax=TongBao.ajax||{},TongBao.ajax.request=function(a,b){function c(){if(4==h.readyState){try{var a=h.status}catch(b){return void e("failure")}e(a),e(a>=200&&300>a||304==a||1223==a?"success":"failure"),window.setTimeout(function(){h.onreadystatechange=TongBao.fn.blank,k&&(h=null)},0)}}function d(){if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}return window.XMLHttpRequest?new XMLHttpRequest:void 0}function e(a){a="on"+a;var b=q[a],c=TongBao.ajax[a];if(b)if(f&&clearTimeout(f),"onsuccess"!=a)b(h);else{try{h.responseText}catch(d){return b(h)}b(h,h.responseText)}else if(c){if("onsuccess"==a)return;c(h)}}var f,g,h,i=b||{},j=i.data||"",k=!(i.async===!1),l=i.username||"",m=i.password||"",n=(i.method||"GET").toUpperCase(),o=i.headers||{},p=i.timeout||0,q={};for(g in i)q[g]=i[g];0!=a.indexOf("http")&&(o["X-Requested-With"]="XMLHttpRequest");try{h=d(),"GET"==n&&(j&&(a+=(a.indexOf("?")>=0?"&":"?")+j,j=null),i.noCache&&(a+=(a.indexOf("?")>=0?"&":"?")+"b"+ +new Date+"=1")),l?h.open(n,a,k,l,m):h.open(n,a,k),k&&(h.onreadystatechange=c),"POST"==n&&(o["Content-Type"]=o["Content-Type"]||"application/x-www-form-urlencoded",h.setRequestHeader("Content-Type",o["Content-Type"]),delete o["Content-Type"]);for(g in o)o.hasOwnProperty(g)&&h.setRequestHeader(g,o[g]);e("beforerequest"),p&&(f=setTimeout(function(){h.onreadystatechange=TongBao.fn.blank,h.abort(),e("timeout")},p)),h.send(j),k||c()}catch(r){e("failure")}return h},TongBao.ajax.get=function(a,b){return TongBao.ajax.request(a,{onsuccess:b})},TongBao.ajax.post=function(a,b,c){return TongBao.ajax.request(a,{onsuccess:c,method:"POST",data:b})},TongBao.url=TongBao.url||{},TongBao.url.jsonToQuery=function(a){var b,c,d,e=[];for(b in a)if(c=a[b],"[object Array]"==Object.prototype.toString.call(c))for(d=c.length;d--;)e.push(b+"="+encodeURIComponent(c[d]));else e.push(b+"="+encodeURIComponent(c));return e.join("&")},TongBao.url.queryToJson=function(a){var b,c,d,e,f={};if(a=a.split("&"),a.length<=0)return f;for(b=0;c=a[b];b++)c=c.split("="),d=c[0],e=decodeURIComponent(c[1]),"undefined"==typeof f[d]?f[d]=e:TongBao.lang.isArray(f[d])?f[d].push(e):f[d]=[f[d],e];return f},TongBao.cookie=TongBao.cookie||{},TongBao.cookie._isValidKey=function(a){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(a)},TongBao.cookie.getRaw=function(a){if(TongBao.cookie._isValidKey(a)){var b=new RegExp("(^| )"+a+"=([^;]*)(;|$)"),c=b.exec(document.cookie);if(c)return c[2]||null}return null},TongBao.cookie.get=function(a){var b=TongBao.cookie.getRaw(a);return"string"==typeof b?b=decodeURIComponent(b):null},TongBao.cookie.setRaw=function(a,b,c){if(TongBao.cookie._isValidKey(a)){c=c||{};var d=c.expires;"number"==typeof c.expires&&(d=new Date,d.setTime(d.getTime()+c.expires)),document.cookie=a+"="+b+(c.path?"; path="+c.path:"")+(d?"; expires="+d.toGMTString():"")+(c.domain?"; domain="+c.domain:"")+(c.secure?"; secure":"")}},TongBao.cookie.remove=function(a,b){b=b||{},b.expires=new Date(0),TongBao.cookie.setRaw(a,"",b)},TongBao.cookie.set=function(a,b,c){TongBao.cookie.setRaw(a,encodeURIComponent(b),c)};var TB=function(){function a(a,b,c){var d=a.call(null,b[c]);d&&(b[c]=d)}return{define:function(b,c){var d,e,f,g=b.split("."),h=window;for(d=0,f=g.length-1;f>d;d++)e=g[d],h[e]||(h[e]={}),h=h[e];return e=g[d],h[e]||(h[e]={}),a(c,h,e),h[e]},require:function(a,b){for(var c=a.split("."),d=window,e=0,b=b||blank;e<c.length&&(d=d[c[e++]]););if(!d)throw new Error(a+" is undefined");return b.call(null),e}}}();TB.define("TB.im.config",function(a){a.FACE_ROOT="http://localhost:8080/kf/static/images/",a.face={"ÂæÆÁ¨ë":"1e376a99d4059562772aad9ac065fd71","Â§ßÁ¨ë":"c5ce7689438e5ee92c5942d4885fc198","ÂÅ∑Á¨ë":"d2ff68289e44c32d61f17e9cfb8f781a","ÊÜ®Á¨ë":"564396330c9e704c27533dd0a9f38d56","ÂæóÊÑè":"33991a718d98b7bde46d1656acd1d84f","ÂèØÁà±":"1eac4820cb2162ad0ea9050f730701ea","ÂÆ≥Áæû":"afb7b910b894d8638a5f5f60d66080bb","‰πñ":"6eeeea78151b0d992342b5d974ea9748","Ê∑òÊ∞î":"3567d74d273570047d563a52487b458d","Ë∞ÉÁöÆ":"17a002956048d2cc3e7136a60995f4c5","ÊµÅÊ≥™":"6d177c2e8caa44b47950afd1c2d94ea1","Â§ßÂì≠":"f2468ad19982b6109525f86e60da0a40"}}),TB.define("TB.im.lang",function(a){a.TEXT={WELCOME:"ÊÇ®Â•ΩÔºÅÊúâ‰ªÄ‰πàÈúÄË¶ÅÂ∏ÆÂøôÁöÑ‰πàÔºü",DEFAULT_CSNAME:"Âú®Á∫øÂÆ¢Êúç",FILE_UNSUPPORT:"[Êñá‰ª∂]",FACE_UNSUPPORT:"[Êâ©Â±ïÂ§¥ÂÉè]",IMG_UNSUPPORT:"[ÂõæÁâá]",CFACE_UNSUPPORT:"[Ëá™ÂÆö‰πâÂ§¥ÂÉè]",ONLINE:"ÂÆ¢Êúç#{0}Â∑≤Áªè‰∏äÁ∫ø‰∫ÜÔºåÊÇ®Áé∞Âú®ÂèØ‰ª•ÂèëËµ∑Ê≤üÈÄöÔºÅ",TRANSFER:"ÊÇ®Â∑≤Ë¢´ËΩ¨ÁßªÁªôÂÖ∂‰ªñÂÆ¢Êúç",INPUT:"Ê≠£Âú®ËæìÂÖ•...",RECONNECT:"ËøûÊé•Â∑≤ÊÅ¢Â§çÔºåÊÇ®ÂèØ‰ª•ÁªßÁª≠Ê≤üÈÄö"},a.ERROR={INIT:"ÂØπ‰∏çËµ∑ÔºåÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØïËøûÊé•",CONFLICT:"ÊÇ®ËæìÂÖ•ÁöÑÂÜÖÂÆπÂ≠òÂú®ÂÆâÂÖ®ÈöêÊÇ£ÔºåÂèëÈÄÅÂ§±Ë¥•",OFFLINE:"Áî±‰∫éÁΩëÁªú‰∏≠Êñ≠Êó∂Èó¥ËæÉÈïøÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÁªßÁª≠Ê≤üÈÄö",SEND_FAIL:"Ê∂àÊÅØÁî±‰∫éÁΩëÁªúÂéüÂõ†ÂèëÈÄÅÂ§±Ë¥•",DROP_KICKED:"‰ºöËØùÂ∑≤Ë¢´ÂÆ¢Êúç‰∏≠Ê≠¢",DROP_CHATOVER:"ÊÇ®ÁöÑÊú¨Ê¨°Ê≤üÈÄöÂ∑≤ÁªìÊùü"}}),TB.define("TB.im.message",function(a){function b(a){var b=new RegExp(m,"g"),c=a.replace(/[\n\r]/g,"");return c=c.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(a,b,c){return l[c.toLowerCase()]?"\n":b?b:""}).replace(/<[^>]+>/g,"").replace(/(\n)+/g,"<br />"),c.replace(b,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")}function c(a){return/^\#[\da-f]{6}$/i.test(a)?(a=a.substr(5)+a.substr(3,2)+a.substr(1,2),parseInt(a,16)):0}function d(a){var b,d=["<font"],e=[];return a=a||{},a.fontFamily=a.fontFamily?a.fontFamily.replace(/^"|"$/g,""):"",d.push(' n="'+(a.fontFamily?a.fontFamily:"simsun")+'"'),d.push(' s="'+(a.fontSize?a.fontSize.replace(/\D/g,""):"10")+'"'),b=a.color,d.push(' c="'+(b?c(b):"0")+'"'),d.push(' b="'+("bold"==a.fontWeight||"700"==a.fontWeight?1:0)+'"'),d.push(' i="'+("italic"==a.fontStyle?1:0)+'"'),d.push(' ul="'+("underline"==a.textDecoration?1:0)+'"'),d.push("/>"),e.push('{"type":"font",'),e.push('"n":"'+(a.fontFamily?a.fontFamily:"simsun")+'",'),e.push('"s":"'+(a.fontSize?a.fontSize.replace(/\D/g,""):"10")+'",'),e.push('"c":"'+(b?c(b):"0")+'",'),e.push('"b":"'+("bold"==a.fontWeight||"700"==a.fontWeight?1:0)+'",'),e.push('"i":"'+("italic"==a.fontStyle?1:0)+'",'),e.push('"ul":"'+("underline"==a.textDecoration?1:0)+'"'),e.push("}"),{xml:d.join(""),json:e.join("")}}function e(a,b){var c,d,e={};for(c=0;d=b[c];c++)d=j[d],d&&(a=d.replacer(a));return e.json=a.replace(/(^|\x0f)([^\x0f\x0e]+)(\x0f|$)/gm,'$1{"type":"text", "c":"$2"},$3'),e.xml=a.replace(/(^|\x0f)([^\x0f\x0e]+)(\x0f|$)/gm,'$1<text c="$2"/>$3'),e.json=e.json.replace(/\x0f\x0e([^\x0f]+)\x0f/g,function(a,b){var c;return b=b.split(" "),c=j[b[0]],c?c.parse(b[1]).json+",":void 0}),e.xml=e.xml.replace(/\x0f\x0e([^\x0f]+)\x0f/g,function(a,b){var c;return b=b.split(" "),c=j[b[0]],c?c.parse(b[1]).xml:void 0}),e.json=e.json.replace(/,\s*$/,""),e}var f=TB.im.config,g=TB.im.lang,h=f.face,i=TongBao.string.encodeHTML,j={face:{replacer:function(a){return a=a.replace(/\(([^)]+)\)/g,function(a,b){var c="("+b+")";return h[b]&&(c="face "+b+""),c})},parse:function(a){var b={};return b.xml='<face n="'+a+'"/>',b.json='{"type":"face","n":"'+a+'"}',b}}},k={text:function(a){var b=i(a.c);return b.replace(/\r\n/gi,"<br/>").replace(/&amp;#xD;&amp;#xA;/gi,"<br/>").replace(/%2B/gi,"+")},url:function(a){var b="";return/^https?:\/\//.test(a.ref)||(b="http://"),'<a href="'+b+a.ref+'" target="_blank">'+a.c+"</a>"},html:function(a){return b(a.c)},face:function(a){var b=h[a.n];return b?'<img src="'+f.FACE_ROOT+b+'.gif" />':g.TEXT.FACE_UNSUPPORT},img:function(){return g.TEXT.IMG_UNSUPPORT},cface:function(){return g.TEXT.CFACE_UNSUPPORT}},l={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1},m="‚Äã";a.parseText=function(a){var b,c=[],f=[];return b=d(),f.push(b.xml),c.push(b.json),b=e(a,["face"]),f.push(b.xml),c.push(b.json),{xml:"<msg>"+f.join("")+"</msg>",json:"["+c.join(",")+"]"}},a.parseMessage=function(a){var b,c,d,e=[];for(b=0;c=a[b];b++)d=k[c.type],d&&e.push(d(c));return e.join("")}}),TB.define("TB.im.net",function(a){function b(a,b){var c=document.getElementsByTagName("head")[0];t(a)&&c.removeChild(t(a)),b.indexOf("_t")<0&&(b+=(b.indexOf("?")>=0?"&":"?")+"_t="+e());var d=document.createElement("script");d.setAttribute("type","text/javascript"),d.setAttribute("language","javascript"),d.setAttribute("id",a),d.setAttribute("src",b),d.setAttribute("charset","UTF-8"),c.appendChild(d)}function c(c,d,e){if(e){var f="jsonp_"+ +new Date;a.callback[f]=function(a){e.call(null,a)},d+=d.indexOf("?")>=0?"&callback=TB.im.net.callback."+f:"?callback=TB.im.net.callback."+f}b(c,d)}function d(a){var b=new Image,c="__IMG_"+e()+"__";a.indexOf("_t")<0&&(a+=(a.indexOf("?")>=0?"&":"?")+"_t="+e()),window[c]=b,b.onload=b.onerror=function(){window[c]=null},b.src=a,b=null}function e(){return(new Date).getTime().toString(36)}function f(a,b){var c=b.onsuccess,d=b.onfailure,f=b.data||"";return b.onsuccess=function(a,b){b=v(b),b.result&&"ok"==b.result.toLowerCase()?c&&c.call(null,b.content):d&&d.call(null,b.result,b.content)},b.onfailure=function(){d&&d.call()},"POST"==b.method?(a+="?_t="+e(),f+="&session="+F.session,f+="&seq="+F.seq++,"&"==f.charAt(0)&&(f=f.substring(1)),b.data=f):(f=[],f.push("_t="+e()),f.push("session="+F.session),f.push("seq="+F.seq++),a+=(a.indexOf("?")>=0?"&":"?")+f.join("&")),u.request(a,b)}function g(a,b,c,d){return f(a,{method:"POST",data:b,onsuccess:c,onfailure:d})}function h(a,b,c){return f(a,{method:"GET",onsuccess:b,onfailure:c})}function i(b){var c,d;if(!I){if(b.fields&&"[object Array]"==Object.prototype.toString.call(b.fields))for(F.ack=b.ack||F.ack,TongBao.cookie.set("BRIDGE_ACK",F.ack,{expires:15e3}),c=0;d=b.fields[c];c++)A[d.command]&&A[d.command](d);I||a.fire("pick","response",{status:0,bid:F.bid,session:F.session,seq:F.seq,ack:F.ack})}}function j(b){"offline"==b||"kicked"==b?a.fire("error","offline"):I||a.fire("pick","response",{status:1,bid:F.bid,session:F.session,seq:F.seq,ack:F.ack})}function k(){clearTimeout(y);var a=w;w=null,a.abort(),w||m()}function l(a,b){return function(){var c=Array.prototype.slice.call(arguments);a===x&&(w=null,clearTimeout(y),"success"==b?i.apply(null,c):j.apply(null,c),I||setTimeout(function(){m()},0))}}function m(){if(!w){x++;var a=TongBao.cookie.get("BRIDGE_ACK");w=h(H.HI_SERVER+"pick?imuss="+F.bid+"&ack="+(null==a?F.ack:a),l(x,"success"),l(x,"failure")),y=setTimeout(k,4e4)}}function n(){a.fire("stat_visitor")}function o(b,c){a.fire("error",b,c)}function p(a){g(H.HI_SERVER+"communicate","imuss="+a.bid+"&from=&to="+a.to+"&tid="+a.tid+"&siteid="+a.siteid+"&body="+a.msg+"&time="+a.time+"&messageid="+a.id,n,o)}function q(a){p(a),a.resendTick=null,a.failTick=setTimeout(function(){o("sendFail",a.content||""),delete C[a.time]},2e4)}function r(a){var b,c,d;for(b=0;c=a[b];b++)d=C[c],d&&(clearTimeout(d.resendTick),clearTimeout(d.failTick),delete C[c])}function s(a,b){g(H.HI_SERVER+"msgack","imuss="+F.bid+"&from="+encodeURIComponent(TB.im.getData("referrer"))+"&to="+encodeURIComponent(TB.im.getData("userName"))+"&to_sub="+(b||"0")+"&ackid="+a)}var t=TongBao.dom.g,u=TongBao.ajax,v=TongBao.json.parse,w=null,x=0,y=null,z=null,A={},B={},C={},D={},E={},F={seq:0,bid:"",siteid:"",session:""},G={RCV_ENTER:"__SCRIPT_RCV_ENTER__",RCV_REFRESH:"__SCRIPT_RCV_REFRESH__",TB_GETUSERNAME:"__SCRIPT_TB_USERNAME__",TB_GETGROUPNAME:"__SCRIPT_TB_GETGROUPNAME__"},H={RCV_ROOT:"http://localhost:8080",TB_ROOT:"http://localhost:8080",HI_SERVER:"/mykf/server.php"},I=!1;A.message=function(b){var c,d;void 0==b.showOnceType?void 0==b.time?a.fire("pick","message",b.content,b.time,b.from_sub):(c=b.time,s(c,b.from_sub),B[c]||(B[c]=!0,a.fire("pick","message",b.content,b.time,b.from_sub))):(d=b.showOnceType,1==d&&void 0!=b.time&&s(b.time,b.from_sub),E[d]||(E[d]=!0,a.fire("pick","message",b.content,b.time,b.from_sub))),b.acks&&r(b.acks.split(";"))},A.msgacknotify=function(a){r(a.content.acks.split(";"))},A.scenefocusnotify=function(){a.fire("pick","previewstart")},A.sceneunfocusnotify=function(){a.fire("pick","previewend")},A.scenemsgnotify=function(){a.fire("pick","input")},A.sendfileacknotify=function(){},A.sendfilecancelnotify=function(){},A.sendfilenotify=function(b){b=b.content,g(H.HI_SERVER+"sendfilecancel","username="+b.username+"&fid="+encodeURIComponent(b.fid)+"&imuss="+F.bid),a.fire("pick","fileUnsupport")},A.sendfilestatusnotify=function(){},A.communicatetransfernotify=function(b){a.fire("pick","transfer",b.content)},A.kicknotify=function(b){b.content&&"1"==b.content.type?a.fire("pick","kick"):b.content&&"2"==b.content.type&&a.fire("pick","chatover")},A.assigntaskacknotify=function(b){a.fire("pick","assigntask",b.content)},A.taskbeginnotify=function(b){a.fire("pick","taskbegin",b.content)},A.offlinenotify=function(b){a.fire("pick","offline",b.content)},a.init=function(a){F.siteid=a.siteid,u.init&&u.init()},a.setSession=function(a){F.session=a},a.setBid=function(a){F.bid=a},a.enter=function(a){var c=H.RCV_ROOT+"Enter.php";a&&(c+="?"+a),b(G.RCV_ENTER,c)},a.rcvRefresh=function(c){var d=H.RCV_ROOT+"Refresh.php";d+="?callback=TB.im.net.handleRefresh&bid="+F.bid+"&siteid="+F.siteid,z=setInterval(function(){b(G.RCV_REFRESH,d)},15e3),c&&a.on("refresh",c)},a.leave=function(){d(H.RCV_ROOT+"Leave.php?bid="+F.bid+"&siteid="+F.siteid)},a.handleRefresh=function(b){0==b.saved?clearTimeout(z):a.fire("refresh",b)},a.welcome=function(a,b,c){g(H.HI_SERVER+"welcome",a,b,c)},a.bridgeInit=function(a,b,c){g(H.HI_SERVER+"bridgeinit",a,b,c)},a.getPrepareWord=function(a,b,c){g(H.HI_SERVER+"prepare",a,b,c)},a.pick=function(a,b){F.ack=a||"",F.seq=b||0,m()},a.stopPick=function(){I=!0,w&&(w.abort(),w=null),clearTimeout(y)},a.sendPreview=function(a,b){g(H.HI_SERVER+"scenemsg","imuss="+b.bid+"&to="+b.to+"&body="+a)},a.communicate=function(a,b,c){var d=(new Date).getTime(),e={bid:F.bid,msg:encodeURIComponent(a),tid:b.tid,siteid:F.siteid,to:encodeURIComponent(b.to)};e.content=c,e.id=F.seq,e.time=d,e.resendTick=setTimeout(function(){q(e)},2e4),C[d]=e,p(e)},a.logout=function(){g(H.HI_SERVER+"logout","imuss="+F.bid)},a.getClientName=function(a,b){var d=["siteid="+F.siteid];d.push("subid="+a),c(G.TB_GETUSERNAME,H.TB_ROOT+"?module=default&controller=webim&action=getUserName&"+d.join("&"),b)},a.getGroupName=function(a,b,d){var e=["siteid="+F.siteid];e.push(d?"subid="+a:"groupid="+a),c(G.TB_GETGROUPNAME,H.TB_ROOT+"?module=default&controller=webim&action=getGroupName&"+e.join("&"),b)},a.setURL=function(a){var b;for(b in H)a[b]&&(H[b]=a[b])},a.on=function(a,b){var c=D[a];c||(c=D[a]=[]),c.push(b)},a.fire=function(){var a,b,c,d=Array.prototype.slice.call(arguments);for(c=D[d[0]]||[],d=d.slice(1),a=0;b=c[a];a++)b.apply(null,d)},a.callback={}}),TB.define("TB.im",function(a){function b(){var a=(new Date).getTimezoneOffset(),b=parseInt(a/60,10),c=a%60,d="-";return(0>b||0>c)&&(d="+",b=-b,0>c&&(c=-c)),b+="",c+="","UTC"+d+b+":"+c}function c(){var a=window.navigator,c=window.screen,d={};return d.lang=a.language||a.systemLanguage,d.rsl=c.width+"*"+c.height,d.tz=b(),d.cbit=c.colorDepth,d}function d(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function e(a){var b;try{b=u(t.getItem(D)||"{}")}catch(c){b={}}return a?b[a]:b}function f(a,b){var c=e();c[a]=b;try{try{t.setItem(D,v(c))}catch(d){t.clear(),t.setItem(D,v(c))}}catch(f){}}function g(){var a=Array.prototype.slice.call(arguments),b=y[a[0]];b&&b.apply(null,a.slice(1))}function h(){var a=Array.prototype.slice.call(arguments),b=z[a[0]];b&&b.apply(null,a.slice(1))}function i(b){var c;D+=b.siteid||"",c=e(),d(A,c),d(A,b||{}),A.bid||(A.bid=c.bid||""),q.on("error",g),q.on("pick",h),q.on("stat_visitor",function(){a.fire("stat_visitor")})}function j(b,c){switch(b){case B.WAIT:l(c),A.initStatus=1,c.autoResponse&&c.autoResponse.length>0&&a.fire("info",r.parseMessage(c.autoResponse));break;case B.DROP:a.fire("error",{type:"kick",msg:s.ERROR.DROP_KICKED}),k();break;default:m()}}function k(){f("pickInfo",{}),q.stopPick(),a.fire("stop")}function l(b){b.subid&&(A.subid=b.subid,e("fs")||f("fs",b.subid),f("ls",b.subid)),2==A.csNameType&&A.subid&&q.getClientName(A.subid,a.updateCSName),A.tid=b.tid,q.pick(b.ack,b.seq),a.fire("init",{bid:A.bid});var c=A.lc||0;f("lc",c+1)}function m(){a.fire("error",{type:"init",msg:s.ERROR.INIT})}function n(a,b){var c;if(0==A.csNameType||3==A.csNameType)c="Âú®Á∫øÂÆ¢Êúç";else{if(!A.csNameMap[a]){var d=1==A.csNameType?"ÈªòËÆ§ÂàÜÁªÑ":"Âú®Á∫øÂÆ¢Êúç",e=1==A.csNameType?q.getGroupName:q.getClientName,f=setTimeout(function(){f=null,A.csNameMap[a]=d,b&&b.call(null,d)},3e3);return void e(a,function(c){c.data=c.data.replace(/^.*?:/,"");var e=A.csNameMap[a]=c.status?d:c.data;f&&(clearTimeout(f),b&&b.call(null,e))},!0)}c=A.csNameMap[a]}return c&&b&&b.call(null,c),c}function o(a){A.session=a.session,q.setSession(a.session),q.bridgeInit("type="+A.type+"&chattype=1&sub="+A.subid+"&username="+encodeURIComponent(A.userName)+"&siteid="+A.siteid+"&bridgetid="+A.tid+"&fromsite="+encodeURIComponent(A.referrer)+"&srcword="+encodeURIComponent(A.word)+"&wordtype="+A.wordtype+"&wordid="+A.wordid+"&region="+encodeURIComponent(A.from)+"&insite="+encodeURIComponent(A.location)+"&title="+encodeURIComponent(A.title)+"&imuss="+A.bid,l,j)}var p=1500,q=TB.im.net,r=TB.im.message,s=TB.im.lang,t=window.localStorage,u=TongBao.json.parse,v=TongBao.json.stringify,w=TongBao.string.encodeHTML,x={},y={},z={},A={bid:"",type:3,subid:"",siteid:"",tid:0,referrer:"",location:"",title:"",coding:"utf8",word:"",wordtype:"",wordid:"",bdclickid:"",from:"",userName:"",csName:s.TEXT.DEFAULT_CSNAME,initStatus:0,lv:0,lvp:0,lc:0,ls:"",previewTimer:null,csNameMap:{}},B={WAIT:"wait",DROP:"block"},C=!1,D="BRIDGE_WEBIM_DATA_";y.conflict=function(){a.fire("error",{type:"conflict",msg:s.ERROR.CONFLICT})},y.sendFail=function(b){var c=s.ERROR.SEND_FAIL;b&&(c+="<br />‚Äú"+b+"‚Äú"),a.fire("error",{type:"sendfail",msg:c})},y.offline=function(){a.fire("error",{type:"offline",msg:s.ERROR.OFFLINE}),k()},z.previewstart=function(){A.previewTimer&&clearInterval(A.previewTimer),A.previewTimer=setInterval(function(){a.fire("sendpreview",function(a){a&&(a=r.parseText(a).xml,q.sendPreview(a,{bid:A.bid,to:A.userName}))})},p)},z.previewend=function(){A.previewTimer&&(clearInterval(A.previewTimer),A.previewTimer=null)},z.fileUnsupport=function(){a.fire("message",s.TEXT.FILE_UNSUPPORT,A.csName,(new Date).getTime())},z.assigntask=function(b){b.result&&(A.tid=void 0!==b.tid?b.tid:A.tid,A.subid=void 0!==b.subid?b.subid:A.subid,!e("fs")&&b.subid&&f("fs",b.subid),f("ls",A.subid)),A.initStatus&&(a.fire("info",s.TEXT.ONLINE.replace("#{0}",b.from||"")),2==A.csNameType&&(A.csName=b.from))},z.taskbegin=function(b){A.chatId=b.sessionid,A.subid=void 0!==b.subid?b.subid:A.subid,!e("fs")&&b.subid&&f("fs",b.subid),f("ls",A.subid);var c=e("statInfo")||{},d=A.siteidstr||c.si,g=A.mainid||c.mID;f("statInfo",{cID:A.chatId,si:d,mID:g}),a.fire("taskbegin",{subid:A.subid,chatid:A.chatId,bid:A.bid,mainid:g,siteidstr:d})},z.kick=function(){a.fire("error",{type:"kick",msg:s.ERROR.DROP_KICKED}),k()},z.chatover=function(){a.fire("error",{type:"kick",msg:s.ERROR.DROP_CHATOVER}),k()},z.offline=function(){a.fire("offline")},z.response=function(a){var b={time:(new Date).getTime()};b.bid=a.bid,b.session=a.session,b.ack=a.ack,b.seq=a.seq,b.tid=A.tid,b.subid=A.subid,f("pickInfo",b)},z.transfer=function(b){A.tid=b.new_tid,A.subid=b.new_subid,f("ls",A.subid),1==A.csNameType?q.getGroupName(A.tid,a.updateCSName):2==A.csNameType&&q.getClientName(A.subid,a.updateCSName),a.fire("transfer"),a.fire("info",s.TEXT.TRANSFER)},z.message=function(b,c,d){c||(c=(new Date).getTime()),n(d,function(d){a.fire("message",r.parseMessage(b),d,c)})},z.input=function(){a.fire("input",s.TEXT.INPUT)},a.init=function(a){var b,c;i(a);for(b in TB.im)TB.im.hasOwnProperty(b)&&(c=TB.im[b],"[object Object]"==Object.prototype.toString.call(c)&&c.init&&c.init(A))},a.sendText=function(a){q.communicate(r.parseText(w(a)).xml,{tid:A.tid,to:A.userName},a)},a.login=function(){C=!1,q.enter("callback=TB.im.handleEnter&siteid="+A.siteid+"&bid="+A.bid+"&referrer="+encodeURIComponent(A.referrer)+"&iswebim=1&word="+encodeURIComponent(A.word)+"&coding="+A.coding+"&bdclickid="+A.bdclickid+"&title="+encodeURIComponent(A.title)+"&inurl="+encodeURIComponent(A.location)+"&vis_type=2&lv="+(A.lv||"0")+"&lc="+(A.lc||"0")+"&ls="+(A.ls||"")+"&lvp="+(A.lvp||"0")+"&ftime="+(A.ft||"0")+"&fs="+(A.fs||"")+"&ltime="+(A.lt||"0")+"&"+TongBao.url.jsonToQuery(c()))},a.logout=function(){C||(q.leave(),C=!0)},a.handleEnter=function(b){d(A,b),q.setBid(A.bid),f("bid",A.bid),f("lt",b.ltime||0),f("ft",b.ft||0),f("lv",b.lv||0),f("lvp",b.lvp||0);var c=e("pickInfo");if(c&&c.time){var g=(new Date).getTime();if(g-c.time<=12e4){q.setBid(c.bid),q.setSession(c.session),A.subid=c.subid,l({tid:c.tid,ack:c.ack,seq:c.seq}),z.previewstart(),a.fire("info",s.TEXT.RECONNECT);var h=e("ls")||0,i=e("statInfo")||{},j=i.cID,k=i.mID,n=i.si;a.fire("revert",{chatid:j,subid:h,bid:A.bid,mainid:k,siteidstr:n})}else q.welcome("source=0&imuss="+A.bid+"&anonym=true&clienttype=2",o,m),f("pickInfo",{})}else q.welcome("source=0&imuss="+A.bid+"&anonym=true&clienttype=2",o,m);q.rcvRefresh(function(a){A.initStatus=1==a.cstatus||4==a.cstatus?1:0})},a.getData=function(a){return A[a]},a.updateCSName=function(a){A.csName=!a||void 0===a.status||a.status?s.TEXT.DEFAULT_CSNAME:a.data.replace(/.*?:/,"")||s.TEXT.DEFAULT_CSNAME},a.on=function(a,b){var c=x[a];c||(c=x[a]=[]),c.push(b)},a.fire=function(){var a,b,c,d=Array.prototype.slice.call(arguments);for(c=x[d[0]]||[],d=d.slice(1),a=0;b=c[a];a++)b.apply(null,d)}}),TB.define("TB.stat",function(){function a(){return Math.floor(1e10*Math.random())}function b(a){var b=new Image,c=j+"?"+a;b.onload=b.onerror=function(){b=null},b.src=c}function c(a,b){for(var c in a)a.hasOwnProperty(c)&&b[c]&&(a[c]=b[c])}function d(c){var d="si="+h.siteId+"&et=99&ep="+h.mainId;d+=e(c),d=d+l+a(),b(d)}function e(a){var b,c,d="",e=n.length;for(b=0;e>b;b++)c=n[b],d+=""===a[c]?"*"+k:"*"+a[c];return d}function f(a){o.visitor_count&&(c(i,a),i.eventId=m.VISITOR_IM,i.count=o.visitor_count,i.valid=1,d(i),o.visitor_count=0,i.valid=0)}function g(a){a.chatId?(c(i,a),i.eventId=m.VISITOR_IM,i.valid=1,d(i),o.visitor_count=0,i.valid=0):o.visitor_count+=a.count}var h={siteId:"",mainId:""},i={mainId:"",subId:"",sessionId:"",eventId:"",chatId:"",from:"",open:"",valid:"",count:""},j="http://hm.tongbao.com/hm.gif",k=0,l="&nv=0&st=4&v=bridge-0.2&rnd=",m={REFRESH_IM:1,SEND_INVITE:3,ACCEPT_INVITE:4,SEND_MESS:5,VISITOR_IM:6,SERVER_IM:7,START_IM:0},n=["subId","sessionId","eventId","chatId","from","open","valid","count"],o={visitor_count:0};return function(a,b,e){if(a)switch(h.siteId=h.siteId||b.siteId||0,h.mainId=h.mainId||b.mainId||0,a=a.toUpperCase()){case"VISITOR_IM":g(e);break;case"START_IM":f(e);break;default:c(i,e),i.eventId=m[a],d(i)}}}),TB.define("TB.src.mobilewebim.log",function(a){function b(a){var b=[];for(var c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")}var c="http://TB.tongbao.com/v3/statlog/stat.gif";a.send=function(a,d){var e,f="_LOG_IMG_"+(new Date).getTime()+"_";d=d||{},d.type=a,d.vis="mobile",d.req=(new Date).getTime().toString(16),window[f]=e=new Image,e.onload=e.onerror=function(){window[f]=null},e.src=c+"?"+b(d),e=null},a.setURL=function(a){c=a||c}}),TB.define("TB.src.stat",function(a){function b(){i.chatId="",clearInterval(f)}function c(){f=window.setInterval(function(){g("REFRESH_IM",j,i)},6e5)}function d(a){i.subId=a.subid,i.chatId=a.chatid,i.bid=a.bid,i.sessionId=j.siteId+"_"+i.bid,!j.siteId&&(j.siteId=a.siteidstr),!j.mainId&&(j.mainId=a.mainid),g("START_IM",j,i),c()}function e(a){i.subId=a.subid,i.chatId=a.chatid,i.bid=a.bid,!j.siteId&&(j.siteId=a.siteidstr),!j.mainId&&(j.mainId=a.mainid),i.sessionId=j.siteId+"_"+i.bid,c()}var f,g=TB.stat,h=TB.im,i={from:0,open:3,count:1},j={siteId:"",mainId:"",bid:""};h.on("stat_visitor",function(){g("VISITOR_IM",j,i)}),h.on("taskbegin",function(a){d(a)}),h.on("message",function(){i.chatId&&g("SERVER_IM",j,i)}),h.on("offline",function(){b()}),h.on("transfer",function(){b()}),h.on("error",function(a){"kick"==a.type&&b()}),h.on("revert",function(a){e(a)}),a.init=function(a){j.siteId=a.siteidstr||0,j.mainId=a.mainid||0}}),TB.define("TB.src.lightapp.stat",function(a){function b(){var a=window.location.search||"";a=a.replace(/^\?/,"");var b=TongBao.url.queryToJson(a)||{};return b}function c(a){h.bid=a.bid;var c=b();h.siteId=c.siteid||"",h.lightapp=c.lightapp||"",h.msg=f.CONNECTION_SUCCESS,d.send(g,h)}var d=TB.src.mobilewebim.log,e=TB.im,f={CONNECTION_SUCCESS:"connection_success"},g="lightapp",h={siteId:"",mainId:"",bid:""};e.on("taskbegin",function(a){c(a)}),a.init=function(a){h.siteId=a.siteId||0}}),TB.define("TB.src.mobilewebim.webim",function(a){function b(a){return a=M(a),a=a.replace(/\(([^)]+)\)/g,function(a,b){return V[b]?'<img src="'+W+V[b]+'.gif" />':a})}function c(a,b){var c=a.className.split(/\s+/)[0];a.addEventListener("click",function(a){fireClickHandler(b,this,a)},!1),a.addEventListener("touchstart",function(){this.className+=" "+c+"-active"},!1),a.addEventListener("touchend",function(a){this.className=this.className.replace(new RegExp("\\s+"+c+"-active\\b","g"),""),b.call(this,a)},!1)}function d(a){e(),a.style.display="",modalEles.push(a)}function e(){for(var a,b=0;a=modalEles[b];b++)a.style.display="none",a.onhide&&a.onhide();modalEles=[]}function f(a){var b=V[a];b&&(R.input.value+="("+a+")")}function g(a){var b=U[a];b&&(R.input.value+=b)}function h(){var a=this.getAttribute("data-key");f(a),x("click",{m:"face",v:a})}function i(){var a=this.getAttribute("data-index");g(a),x("click",{m:"word",v:a})}function j(){var a=G("bt-target"),b="bt"+Math.floor(1e3*Math.random());a.name=b,location.hash=b}function k(a){function b(){d>c&&(F.sendText(a[c++]),setTimeout(b,500))}var c=0,d=a.length;b()}function l(){function a(){g||(F.logout(),n(),g=!0,x("logout",{time:(new Date).getTime()}))}function f(){fireClickHandler=blank,window.removeEventListener("touchstart",f,!0)}var g=!1;window.addEventListener("unload",a,!1),window.addEventListener("beforeunload",a,!1),window.addEventListener("offline",function(){S.cachedMsg||(S.cachedMsg=[])}),window.addEventListener("online",function(){S.cachedMsg&&(k(S.cachedMsg),S.cachedMsg=null)}),c(R.sendBtn,function(){if(!R.sendBtn.disabled){var a=H(R.input.value),c={type:"client",time:J(new Date,"HH:mm:ss"),csName:"Êàë"};if(""===a)return void(R.input.value="");c.content=b(a),T.firstSended&&(a+="„ÄêËÆøÂÆ¢Ê≠£Âú®ÈÄöËøáÊâãÊú∫Ê≤üÈÄö„Äë",T.firstSended=!1),S.cachedMsg?S.cachedMsg.push(a):(F.sendText(a),x("sendmsg")),R.input.value="",R.input.blur(),u(c)}}),c(R.faceBtn,function(a){this.className.indexOf("btn-actived")>=0||(this.className+=" btn-actived",d(R.faceLayer),a.stopPropagation())}),c(R.wordBtn,function(a){this.className.indexOf("btn-actived")>=0||(this.className+=" btn-actived",d(R.wordList),a.stopPropagation())}),R.faceLayer.onhide=function(){R.faceBtn.className=R.faceBtn.className.replace(/\s+btn-actived\b/g,"")},B(),R.wordList.onhide=function(){R.wordBtn.className=R.wordBtn.className.replace(/\s+btn-actived\b/g,"")},F.on("message",function(a,b,c){var d={type:"server",csName:b},e=new Date;e.setTime(c),d.time=J(e,"HH:mm:ss"),d.content=a,u(d)}),F.on("error",function(a){a.msg&&u({type:"error",content:a.msg})}),F.on("info",function(a){u({type:"info",content:a})}),F.on("input",function(a){m(a)}),F.on("init",function(a){R.sendBtn.disabled=!1,m("ËΩ¨Êé•ÊàêÂäüÔºÅ"),Q.bid=a.bid}),F.on("stop",function(){R.sendBtn.disabled=!0});var h="";F.on("sendpreview",function(a){var b=H(R.input.value);b!=h&&(h=b,a(b))}),window.addEventListener("touchstart",f,!0),window.addEventListener("touchend",function(){e()},!1),window.addEventListener("click",function(a){fireClickHandler(e,this,a)},!1)}function m(a,b){E&&clearTimeout(E),R.tip.innerHTML=a,R.tip.style.display="",b||(E=setTimeout(function(){R.tip.style.display="none"},3e3))}function n(){try{var a,b,c,d=Y+Q.siteid,e={};e.msgList=S.msgList,e=L(e);try{O.setItem(d,e)}catch(f){for(a=0,b=O.length;b>a;a++)c=O.key(a),0===c.indexOf(Y)&&O.removeItem(c);O.setItem(d,e)}}catch(g){}}function o(a){try{var b;return b=a?a:Y+Q.siteid,K(O.getItem(b))||{}}catch(c){return{}}}function p(){R.wordList=G("wordList"),R.faceLayer=G("faceLayer"),R.input=G("wordInput"),R.sendBtn=G("sendBtn"),R.wordBtn=G("wordBtn"),R.faceBtn=G("faceBtn"),R.content=G("content"),R.custInfo=G("info"),R.tip=G("sysTip"),R.opt=G("opt"),R.tmp=document.createElement("div"),A(U),R.faceLayer.innerHTML='<div class="panel-inner"></div>';var a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;R.content.style.minHeight=a-R.opt.offsetHeight-30+"px"}function q(){var a=[];for(var b in V)if(V.hasOwnProperty(b)){var c={};c.key=b,c.md5=V[b],a.push(c)}s(0,a)}function r(){for(var a,b=R.faceLayer.getElementsByTagName("a"),d=0;a=b[d];d++)c(a,h)}function s(a,b){if(a>=b.length)return void r();var c=b[a],d=new Image,e="_IMG_FACE_"+(new Date).getTime()+"_";window[e]=d,d.onload=function(){var f=document.createElement("a");f.setAttribute("data-key",c.key),f.className="face-item",f.appendChild(d),R.faceLayer.firstChild.appendChild(f),window[e]=null,s(a+1,b)},d.onerror=function(){d=null,window[e]=null,s(a+1,b)},d.src=W+c.md5+".gif"}function t(a){function b(a,b,c){var d=b||"http://";return j.push('<a href="'+d+c+'" target="_blank">'+a+"</a>"),e+"_"+j.length+"$"}function c(a){return j.push('<a href="tel://'+a+'" target="_blank">'+a+"</a>"),e+"_"+j.length+"$"}function d(a,b){return b=parseInt(b,10)-1,j[b]}var e="R_"+Math.floor(1e4*Math.random()),f=0,g=[];a=a.replace(/(<[^>]*>)/g,function(a){return g[f++]=a,e}),a=a.split(e);for(var h,i=[],j=[],k=new RegExp(e+"_(\\d+)\\$","g"),f=0,l=a.length;l>f;f++)h=a[f],h=h.replace(/(https?:\/\/)?([^.\u4e00-\u9fa5 ]+(\.[^.\u4e00-\u9fa5 ]+)+)/g,b),h=h.replace(/(\d{7,})/g,c),h=h.replace(k,d),i.push(h),f<g.length&&i.push(g[f]);return i.join("")}function u(a,b){var c;if("server"==a.type||"client"==a.type){if(c=X.msg,S.msgList.push(N({},a)),a.content)try{a.content=t(a.content)}catch(d){}}else c=X.info;if(R.tmp.innerHTML=I(c,a),R.content.appendChild(c=R.tmp.firstChild),j(),!b&&S.initedTime){var e=(new Date).getTime()-S.initedTime;x("res1st",{v:e}),S.initedTime=null}}function v(a){var b=[];a=a.split("&");for(var c,d=0;c=a[d];d++)c=c.split("="),c.length<2||(b[c[0]]=c[1]);return b}function w(){var a,b=["baidu.com","baidu.com","google.com","google.cn","bing.com","search.live.com","search.yahoo.com","one.cn.yahoo.com","sogou.com","gougou.com","youdao.com","soso.com","zhongsou.com","search.114.vnet.cn"],c=["wd","word","q","q","q","q","p","p","query","search","q","w","w","kw"],d=["gbk","gbk","utf8","utf8","utf8","utf8","utf8","utf8","gbk","utf8","utf8","gbk","gbk","gbk"],e=document.referrer,f={word:"",referrer:e,coding:"utf8"};
if(e=e.split("?"),e.length<2)return f;a=v(e[1]),e=e[0];for(var g=0,h=b.length;h>g;g++)if(!(e.indexOf(b[g])<0)&&void 0!==a[c[g]]){f.word=a[c[g]],f.coding=d[g];break}return f}function x(a,b){b=b||{},b.siteid=Q.siteid,b.bid=Q.bid||"",TB.src.mobilewebim.log.send(a,b)}function y(){var a=(new Date).getTime();F.on("init",function(){var b=S.initedTime=(new Date).getTime();x("connectedtime",{v:b-a})}),F.on("error",function(a){"sendfail"==a.type?x("sendfail"):"init"==a.type&&x("initerror")})}function z(a,b,c){var d=document.getElementsByTagName("head")[0],e=a+"_JSONP_CB",f=G(a);f&&(d.removeChild(G(a)),delete window[e]),window[e]=function(){c.apply(null,arguments)},f=document.createElement("script"),f.charset="utf-8",f.type="text/javascript",b+=b.indexOf("?")>=0?"&callback="+e:"?callback="+e,b+="&req="+(new Date).getTime(),f.src=b,d.appendChild(f)}function A(a){U=a;for(var b,c=["<ol>"],d=0;b=a[d];d++)c.push(I(X.wordItem,{index:d,content:b}));c.push("</ol>"),R.wordList.innerHTML=c.join("")}function B(){for(var a,b=R.wordList.getElementsByTagName("li"),d=0;a=b[d];d++)c(a,i)}function C(a){var b=[];if(a.desc&&b.push(I(X.custDesc,M(a.desc))),a.tel&&b.push(I(X.custTel,{tel:a.tel.replace(/[^0-9]/g,""),telTxt:M(a.tel)})),b.length>0){R.custInfo.innerHTML=b.join(""),R.custInfo.style.display="block";var c=R.custInfo.offsetHeight,d=parseInt(R.content.style.minHeight,10);R.content.style.minHeight=d-c+"px",R.content.style.paddingTop=c+20+"px"}}function D(a){var b={};1==a.cust_dis&&a.cust&&(b.desc=a.cust),S.tel?b.tel=S.tel:1==a.tel_dis&&a.tel&&(b.tel=a.tel),C(b),a.reply&&a.reply.length>0&&(A(a.reply),B())}var E,F=TB.im,G=TongBao.dom.g,H=TongBao.string.trim,I=TongBao.string.format,J=TongBao.date.format,K=TongBao.json.parse,L=TongBao.json.stringify,M=TongBao.string.encodeHTML,N=TongBao.object.extend,O=window.localStorage,P=TongBao.cookie.get,Q={},R={},S={msgList:[]},T={firstSended:!0},U=["ÊÇ®Â•Ω„ÄÇ","ÊàëÁöÑÁóáÁä∂ÊòØ","ËÉΩ‰ªãÁªç‰∏Ä‰∏ãÂêóÔºü","Â§öÂ∞ëÈí±Ôºü","Âì™‰ΩçÂåªÁîüÊúÄÂ•ΩÔºü","ÊÄé‰πàÈ¢ÑÁ∫¶Ôºü","‰Ω†‰ª¨ÁöÑÂú∞ÂùÄÊòØÂì™ÈáåÔºü","Ë∞¢Ë∞¢„ÄÇ","ÂÜçËßÅÔºÅ"],V=F.config.face,W=F.config.FACE_ROOT,X={msg:'<div class="msg msg-#{type}"><div class="msg-title"><em>#{time}</em>#{csName}</div><div class="msg-content">#{content}</div><div class="msg-cursor"></div></div>',info:'<div class="info info-#{type}"><span class="info-icon"></span>#{content}</div>',wordItem:'<li class="word-item" data-index="#{index}" data-log="word#{index}">#{content}</li>',faceItem:'<a class="face-item" data-key="#{key}"><img src="'+W+'#{md5}.gif" /></a>',custDesc:"<p>#{0}</p>",custTel:'<p><span class="tel"></span><a href="tel:#{tel}">#{telTxt}</a></p>'},Y="TB_MOBILE_WEBIM_";blank=function(){},modalEles=[],fireClickHandler=function(a,b,c){a.call(b,c)};var Z={CUST_INFO:"http://localhost:8080/kf/enter.php?module=mobile&controller=mobileim&action=corporation"};a.enter=function(a){var b=w();N(Q,a||{}),F.init({siteid:Q.siteid,mainid:Q.mainid,siteidstr:Q.siteidstr,type:Q.type||3,csNameType:Q.csNameType,userName:Q.userName,tid:Q.groupid,subid:Q.sub||"",word:b.word,coding:b.coding,referrer:document.referrer,bid:Q.bid||""}),p(),l();for(var c,d=o(),e=d.msgList||[],f=0;c=e[f];f++)u(c,!0);m("Ê≠£Âú®‰∏∫ÊÇ®ËΩ¨Êé•ÔºåÁ®çÂÄô..."),y(),F.login(),j();var g="TEL_"+Q.siteid,h=P(g);h&&(S.tel=h,C({tel:h})),z("CUST_INFO",Z.CUST_INFO+"&siteid="+Q.siteid,D),q()}});